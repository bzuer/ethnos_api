*************************** 1. row ***************************
                View: v_institution_productivity
         Create View: CREATE ALGORITHM=UNDEFINED DEFINER=`api_dev`@`%` SQL SECURITY DEFINER VIEW `v_institution_productivity` AS select `o`.`id` AS `id`,`o`.`name` AS `institution_name`,`o`.`type` AS `type`,`o`.`country_code` AS `country_code`,`o`.`city` AS `city`,count(distinct `a`.`work_id`) AS `total_works`,count(distinct `a`.`person_id`) AS `unique_researchers`,count(distinct case when `pub`.`open_access` = 1 then `pub`.`id` end) AS `open_access_works`,round(avg(coalesce(`m`.`citation_count`,0)),2) AS `avg_citations_per_work`,sum(coalesce(`m`.`citation_count`,0)) AS `total_citations`,min(`pub`.`year`) AS `first_publication_year`,max(`pub`.`year`) AS `latest_publication_year`,count(distinct `v`.`id`) AS `venues_published_in`,count(distinct case when `a`.`is_corresponding` = 1 then `a`.`work_id` end) AS `works_as_corresponding` from (((((`organizations` `o` join `authorships` `a` on(`o`.`id` = `a`.`affiliation_id`)) join `works` `w` on(`a`.`work_id` = `w`.`id`)) left join `publications` `pub` on(`w`.`id` = `pub`.`work_id`)) left join `venues` `v` on(`pub`.`venue_id` = `v`.`id`)) left join `metrics` `m` on(`w`.`id` = `m`.`work_id`)) where `o`.`type` in ('UNIVERSITY','INSTITUTE') group by `o`.`id` having `total_works` >= 5 order by count(distinct `a`.`work_id`) desc
character_set_client: utf8mb3
collation_connection: utf8mb3_general_ci
